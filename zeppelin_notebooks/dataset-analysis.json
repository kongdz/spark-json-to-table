{"paragraphs":[{"text":"%md\n## Welcome to Dataset Challenge Analysis.\n##### This notebook provides some sample queries (Shift-Enter to Run)","user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"text","editOnDblClick":false},"editorMode":"ace/mode/text","editorHide":false,"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1490945988322_1194585785","id":"20170331-073948_1318599053","dateCreated":"2017-03-31T07:39:48+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:260","dateUpdated":"2017-03-31T08:56:32+0000","dateFinished":"2017-03-31T08:56:33+0000","dateStarted":"2017-03-31T08:56:32+0000","results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>Welcome to Dataset Challenge Analysis.</h2>\n<h5>This notebook provides some sample queries (Shift-Enter to Run)</h5>\n</div>"}]}},{"text":"%md\n### we start with reading some entities","user":"anonymous","dateUpdated":"2017-03-31T08:56:35+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>we start with reading some entities</h3>\n</div>"}]},"apps":[],"jobName":"paragraph_1490946094846_2061779158","id":"20170331-074134_1510328749","dateCreated":"2017-03-31T07:41:34+0000","dateStarted":"2017-03-31T08:56:35+0000","dateFinished":"2017-03-31T08:56:35+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:261"},{"text":"val business = spark.read.parquet(\"/home/output/businessAsTable\")\nval businessCat = spark.read.parquet(\"/home/output/businessCategories\")\nval businessHours = spark.read.parquet(\"/home/output/businessHours\")\nval checkinTimes = spark.read.parquet(\"/home/output/checkinTimes\") ","user":"anonymous","dateUpdated":"2017-03-31T09:05:27+0000","config":{"colWidth":12,"editorMode":"ace/mode/text","results":{},"enabled":true,"editorSetting":{"language":"text","editOnDblClick":false},"tableHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nbusiness: org.apache.spark.sql.DataFrame = [business_id: string, name: string ... 14 more fields]\n\nbusinessCat: org.apache.spark.sql.DataFrame = [business_id: string, categorie: string]\n\ncheckinTimes: org.apache.spark.sql.DataFrame = [business_id: string, time: string]\n\ncheckinTimes: org.apache.spark.sql.DataFrame = [business_id: string, time: string]\n"}]},"apps":[],"jobName":"paragraph_1490945835082_-1006794179","id":"20170330-115136_1470985803","dateCreated":"2017-03-31T07:37:15+0000","dateStarted":"2017-03-31T09:05:29+0000","dateFinished":"2017-03-31T09:05:33+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:262"},{"text":"business.show(10)","user":"anonymous","dateUpdated":"2017-03-31T09:05:35+0000","config":{"colWidth":12,"editorMode":"ace/mode/text","results":{},"enabled":true,"editorSetting":{"language":"text","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+--------------------+--------------+--------------------+----------+-----+-----------+-------------+--------------+-----+------------+-------+--------------------+--------------------+--------------------+--------+\n|         business_id|                name|  neighborhood|             address|      city|state|postal_code|     latitude|     longitude|stars|review_count|is_open|          attributes|          categories|               hours|    type|\n+--------------------+--------------------+--------------+--------------------+----------+-----+-----------+-------------+--------------+-----+------------+-------+--------------------+--------------------+--------------------+--------+\n|0DI8Dt2PJp07XkVvI...|   Innovative Vapors|              |227 E Baseline Rd...|     Tempe|   AZ|      85283|   33.3782141|   -111.936102|  4.5|          17|      0|BikeParking: True...|Tobacco Shops,Nig...|Monday 11:0-21:0,...|business|\n|LTlCaCGZE14GuaUXU...|       Cut and Taste|              |495 S Grand Centr...| Las Vegas|   NV|      89106|   36.1922841|  -115.1592718|  5.0|           9|      1|BusinessAcceptsBi...|Caterers,Grocery,...|Monday 0:0-0:0,Tu...|business|\n|EDqCEAGXVGCH4FJXg...|         Pizza Pizza|Dufferin Grove|  979 Bloor Street W|   Toronto|   ON|    M6H 1L5|    43.661054|    -79.429089|  2.5|           7|      1|Alcohol: none,Amb...|Restaurants,Pizza...|Monday 11:0-2:0,T...|business|\n|cnGIivYRLxpF7tBVR...| Plush Salon and Spa|              |7014 Steubenville...|   Oakdale|   PA|      15071|40.4445439533|-80.1745398943|  4.0|           4|      1|AcceptsInsurance:...|Hair Removal,Beau...|Tuesday 10:0-21:0...|business|\n|cdk-qqJ71q6P7TJTw...|         Comfort Inn| Downtown Core|   321 Jarvis Street|   Toronto|   ON|    M5B 2C2|   43.6598286|   -79.3754006|  3.0|           8|      1|BusinessAcceptsCr...|Hotels & Travel,E...|                    |business|\n|Q9rsaUiQ-A3NdEAlo...|         A Plus Nail|              |30 Gibson Drive, ...|   Markham|   ON|    L3R 2S3|     43.82764|    -79.342722|  2.5|           3|      1|BusinessAcceptsCr...|Nail Salons,Beaut...|Monday 10:30-20:0...|business|\n|Cu4_Fheh7IrzGiK-P...|      Boomerang Baby|              |10875 N Frankloyd...|Scottsdale|   AZ|      85259|   33.5852707|  -111.8349538|  3.5|           8|      1|BikeParking: True...|Baby Gear & Furni...|Monday 10:0-18:0,...|business|\n|GDnbt3isfhd57T1Qq...|           Taco Bell|              |11072 No Frank Ll...|Scottsdale|   AZ|      85259|     33.58671|    -111.83541|  2.5|           9|      1|Alcohol: none,Amb...|Tex-Mex,Mexican,F...|Monday 10:0-22:0,...|business|\n|qwAHit4Tuj1zpO7Cx...|CubeSmart Self St...|              |11000 North 115th...|Scottsdale|   AZ|      85259|   33.5864403|  -111.8325788|  4.5|          11|      1|BusinessAcceptsCr...|Local Services,Se...|Monday 9:30-18:0,...|business|\n|Nbr0kbtIrVlEcKIZo...|     Sehne Backwaren|              |         Hauptstr. 1| Stuttgart|   BW|      70563|      48.7299|       9.11242|  3.5|           3|      1|BikeParking: True...|       Food,Bakeries|                    |business|\n+--------------------+--------------------+--------------+--------------------+----------+-----+-----------+-------------+--------------+-----+------------+-------+--------------------+--------------------+--------------------+--------+\nonly showing top 10 rows\n\n"}]},"apps":[],"jobName":"paragraph_1490945835084_-1009102673","id":"20170330-115401_17386002","dateCreated":"2017-03-31T07:37:15+0000","dateStarted":"2017-03-31T09:05:36+0000","dateFinished":"2017-03-31T09:05:37+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:263"},{"text":"%md\n### Top 10 business categories in \"Las Vegas\"\n\nusing dataset operations","user":"anonymous","dateUpdated":"2017-03-31T07:47:10+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Top 10 business categories in &ldquo;Las Vegas&rdquo;</h3>\n<p>using dataset operations</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1490945986851_1859047136","id":"20170331-073946_1034934504","dateCreated":"2017-03-31T07:39:46+0000","dateStarted":"2017-03-31T07:47:10+0000","dateFinished":"2017-03-31T07:47:10+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:264"},{"text":"business.filter($\"city\"===\"Las Vegas\")\n.join(businessCat,Seq(\"business_id\"),\"left_outer\")\n.groupBy(\"categorie\")\n.count()\n.orderBy($\"count\" desc)\n.show(10)","user":"anonymous","dateUpdated":"2017-03-31T09:05:43+0000","config":{"colWidth":12,"editorMode":"ace/mode/text","results":{},"enabled":true,"editorSetting":{"language":"text","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nwarning: there was one feature warning; re-run with -feature for details\n+--------------------+-----+\n|           categorie|count|\n+--------------------+-----+\n|         Restaurants| 5431|\n|            Shopping| 3829|\n|                Food| 2535|\n|       Beauty & Spas| 2514|\n|       Home Services| 2332|\n|    Health & Medical| 2133|\n|           Nightlife| 1658|\n|      Local Services| 1604|\n|          Automotive| 1538|\n|Event Planning & ...| 1336|\n+--------------------+-----+\nonly showing top 10 rows\n\n"}]},"apps":[],"jobName":"paragraph_1490945835085_-1009487422","id":"20170330-121642_2100643931","dateCreated":"2017-03-31T07:37:15+0000","dateStarted":"2017-03-31T09:05:44+0000","dateFinished":"2017-03-31T09:05:47+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:265"},{"text":"%md\n### demonstrating sql","user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"text","editOnDblClick":false},"editorMode":"ace/mode/text","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1490946700160_-1373036261","id":"20170331-075140_231750095","dateCreated":"2017-03-31T07:51:40+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:266","dateUpdated":"2017-03-31T09:05:55+0000","dateFinished":"2017-03-31T09:05:50+0000","dateStarted":"2017-03-31T09:05:50+0000","results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>demonstrating sql</h3>\n</div>"}]}},{"text":"business.registerTempTable(\"business\")\ncheckinTimes.registerTempTable(\"checkinTimes\")\n","user":"anonymous","dateUpdated":"2017-03-31T09:05:58+0000","config":{"colWidth":12,"editorMode":"ace/mode/text","results":{},"enabled":true,"editorSetting":{"language":"text","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nwarning: there was one deprecation warning; re-run with -deprecation for details\n\nwarning: there was one deprecation warning; re-run with -deprecation for details\n"}]},"apps":[],"jobName":"paragraph_1490945835086_-1008333175","id":"20170330-121904_1098942871","dateCreated":"2017-03-31T07:37:15+0000","dateStarted":"2017-03-31T09:05:58+0000","dateFinished":"2017-03-31T09:05:59+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:267"},{"text":"%sql\nselect time, count(1) count_business\nfrom business b \nleft join checkinTimes c on (b.business_id = c.business_id)\nwhere stars >=4.0\ngroup by time \norder by count(1) desc","user":"anonymous","dateUpdated":"2017-03-31T09:19:17+0000","config":{"colWidth":6,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1490951509181_-1225224883","id":"20170331-091149_1660824535","dateCreated":"2017-03-31T09:11:49+0000","status":"ERROR","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1666","dateFinished":"2017-03-31T09:26:46+0000","dateStarted":"2017-03-31T09:19:17+0000","title":"checkin times of Top rated businesses","results":{"code":"ERROR","msg":[{"type":"TEXT","data":"java.lang.OutOfMemoryError: Java heap space\n"}]}},{"text":"%sql\nselect hour, count(1) count_business\nfrom business b \nleft join businessHours h on (b.business_id = h.business_id)\ngroup by hour \norder by count(1) desc","user":"anonymous","dateUpdated":"2017-03-31T09:33:26+0000","config":{"colWidth":6,"enabled":true,"results":{},"editorSetting":{"language":"text","editOnDblClick":false},"editorMode":"ace/mode/text","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1490946685419_-1604117109","id":"20170331-075125_820873690","dateCreated":"2017-03-31T07:51:25+0000","status":"RUNNING","progressUpdateIntervalMs":500,"$$hashKey":"object:270","dateStarted":"2017-03-31T09:33:26+0000","errorMessage":"","title":"Number of businesses per business hour"},{"text":"","user":"anonymous","dateUpdated":"2017-03-31T09:33:26+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1490952806691_-1570663165","id":"20170331-093326_1644700675","dateCreated":"2017-03-31T09:33:26+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1977","errorMessage":""}],"name":"analysis","id":"2CE95BHSP","angularObjects":{"2CDRGS113:shared_process":[],"2CF32UHZQ:shared_process":[],"2CBS3DN27:shared_process":[],"2CBY3UT8C:shared_process":[],"2CFBX9NWE:shared_process":[],"2CERGJCYN:shared_process":[],"2CD8Q9RPT:shared_process":[],"2CFEV8CRA:shared_process":[],"2CBQJEWB8:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}